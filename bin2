const APIS=[{url:'https://api.elevenlabs.io/v1/text-to-speech/',key:'sk_9580010a3cabdcd498a366655325e18c453953b5996dd9a5'},{url:'https://api.elevenlabs.io/v1/text-to-speech/',key:'sk_c0ccbba45dc59327bb3866608670276ad2e577c52bae0f83'},{url:'https://api.elevenlabs.io/v1/text-to-speech/',key:'sk_83df44bd168cc46584510add9e90add5ccd51c34e532ac8b'},{url:'https://api.elevenlabs.io/v1/text-to-speech/',key:'sk_0a33d11da0ba80c0d397180cd7b5a514bf09567597b7afa1'}];const voiceSelect=document.getElementById('voiceSelect');const languageSelect=document.getElementById('languageSelect');const voiceInfo=document.getElementById('voiceInfo');const loading=document.getElementById('loading');const audioPlayer=document.getElementById('audioPlayer');document.querySelectorAll('input[type="range"]').forEach(input=>{document.getElementById(`${input.name}Value`).textContent=input.value;input.addEventListener('input',(e)=>{document.getElementById(`${e.target.name}Value`).textContent=e.target.value})});function updateVoiceInfo(){const voice=voiceSelect.options[voiceSelect.selectedIndex];const lang=languageSelect.options[languageSelect.selectedIndex];voiceInfo.innerHTML=`🎙️ ${voice.textContent} | 🌍 Supports: ${voice.dataset.langs} | Current Language: ${lang.textContent}`}
const SCENARIOS={story:{text:"In a realm where magic flowed like rivers, young Aria discovered she could communicate with dragons...",voice:"21m00Tcm4TlvDq8ikWAM",language:"en",settings:{stability:0.7,similarity:0.75,style:0.8,speed:0.9}},joke:{text:"Why don't scientists trust atoms? Because they make up everything! *ba-dum-tss*",voice:"AZnzlk1XvdvUeBnXmlld",language:"en",settings:{stability:0.5,similarity:0.8,style:1.0,speed:1.2}},ad:{text:"Revolutionize your mornings with Sunrise Cereal! Now with 50% more crunch and 100% more joy!",voice:"EXAVITQu4vr4xnSDxMaL",language:"en",settings:{stability:0.6,similarity:0.85,style:0.9,speed:1.1}},meditation:{text:"Allow your thoughts to drift away... Feel the earth beneath you... Breathe in peace, exhale tension...",voice:"XB0fDUnXU5powFXDhCwa",language:"en",settings:{stability:0.9,similarity:0.7,style:0.2,speed:0.8}},movie:{text:"[Thunder roars] COMMANDER: 'This ends now! For the kingdom! Charge!!!' [Epic orchestra peaks]",voice:"ThT5KcBeYPX3keUQqHPh",language:"en",settings:{stability:0.4,similarity:0.9,style:1.0,speed:1.0}},game:{text:"WARNING: Core systems failing! Player, initiate emergency protocol Delta-7 immediately!",voice:"MF3mGyEYCl7XYWbV9V6O",language:"en",settings:{stability:0.3,similarity:0.95,style:0.7,speed:1.4}},podcast:{text:"Welcome to Future Talk! Today we're exploring AI ethics with Dr. Samantha Cortez...",voice:"TX3LPaxmHKxFdv7VOQHJ",language:"en",settings:{stability:0.5,similarity:0.8,style:0.4,speed:1.0}},multilingual:{text:"Hello! Bonjour! Hola! 你好! नमस्ते! Select different languages to explore!",voice:"EXAVITQu4vr4xnSDxMaL",language:"en",settings:{stability:0.6,similarity:0.8,style:0.5,speed:1.0}}};function loadScenario(type){const scenario=SCENARIOS[type];document.getElementById('textInput').value=scenario.text;voiceSelect.value=scenario.voice;languageSelect.value=scenario.language;['stability','similarity','style','speed'].forEach(setting=>{const input=document.querySelector(`input[name="${setting}"]`);input.value=scenario.settings[setting];input.dispatchEvent(new Event('input'))});updateVoiceInfo()}
async function generateSpeech(){const text=document.getElementById('textInput').value.trim();const voiceId=voiceSelect.value;const language=languageSelect.value;if(!text)return alert('Please enter some text');try{loading.style.display='block';audioPlayer.style.display='none';let audioData;let lastError;for(const api of APIS){try{const response=await fetch(`${api.url}${voiceId}`,{method:'POST',headers:{'Accept':'audio/mpeg','Content-Type':'application/json','xi-api-key':api.key},body:JSON.stringify({text:text,model_id:'eleven_multilingual_v2',voice_settings:{stability:parseFloat(document.querySelector('input[name="stability"]').value),similarity_boost:parseFloat(document.querySelector('input[name="similarity"]').value),style:parseFloat(document.querySelector('input[name="style"]').value)},speed:parseFloat(document.querySelector('input[name="speed"]').value),language_id:language})});if(!response.ok){throw new Error(`API Error: ${response.status} - ${await response.text()}`)}
audioData=await response.blob();lastError=null;break}catch(error){lastError=error;console.warn(`API attempt failed (${api.url}):`,error.message)}}
if(!audioData){throw lastError||new Error('All API attempts failed')}
audioPlayer.src=URL.createObjectURL(audioData);audioPlayer.style.display='block';audioPlayer.play()}catch(error){console.error('Final error:',error);alert(`Speech generation failed: ${error.message}`)}finally{loading.style.display='none'}}
voiceSelect.addEventListener('change',updateVoiceInfo);languageSelect.addEventListener('change',updateVoiceInfo);updateVoiceInfo();
